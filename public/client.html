<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Socket.IO Client</title>
    <script src="https://cdn.socket.io/4.8.1/socket.io.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        .subtitle {
            color: #666;
            margin-bottom: 30px;
        }
        .status {
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .status.connected {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status.disconnected {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .events-section {
            margin-top: 30px;
        }
        .event-box {
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 4px;
            border-left: 4px solid #007bff;
            background-color: #f8f9fa;
        }
        .event-box.notification {
            border-left-color: #28a745;
        }
        .event-box.alert {
            border-left-color: #ffc107;
        }
        .event-box.emergency {
            border-left-color: #dc3545;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .event-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        .event-content {
            color: #666;
            font-size: 14px;
        }
        .event-time {
            color: #999;
            font-size: 12px;
            margin-top: 5px;
        }
        .clear-btn {
            padding: 10px 20px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        .clear-btn:hover {
            background-color: #5a6268;
        }
        .no-events {
            text-align: center;
            color: #999;
            padding: 30px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Socket.IO Client</h1>
        <p class="subtitle">Listening for events from the server</p>

        <div id="status" class="status disconnected">
            Status: Disconnected
        </div>

        <div class="events-section">
            <h2>Received Events</h2>
            <button class="clear-btn" onclick="clearEvents()">Clear All Events</button>
            <div id="events">
                <div class="no-events">No events received yet. Waiting for server messages...</div>
            </div>
        </div>
    </div>

    <script>
        const socket = io('http://localhost:1024');
        let eventCount = 0;

        // Update connection status
        function updateStatus(connected) {
            const statusDiv = document.getElementById('status');
            if (connected) {
                statusDiv.className = 'status connected';
                statusDiv.textContent = 'Status: Connected to server';
            } else {
                statusDiv.className = 'status disconnected';
                statusDiv.textContent = 'Status: Disconnected';
            }
        }

        // Display received event
        function displayEvent(eventName, data, eventType = 'default') {
            const eventsDiv = document.getElementById('events');

            // Remove "no events" message if it exists
            const noEvents = eventsDiv.querySelector('.no-events');
            if (noEvents) {
                noEvents.remove();
            }

            const eventBox = document.createElement('div');
            eventBox.className = `event-box ${eventType}`;

            const title = document.createElement('div');
            title.className = 'event-title';
            title.textContent = `Event: ${eventName}`;

            const content = document.createElement('div');
            content.className = 'event-content';

            // Format the data nicely
            if (typeof data === 'object') {
                content.textContent = JSON.stringify(data, null, 2);
                content.style.whiteSpace = 'pre-wrap';
            } else {
                content.textContent = data;
            }

            const time = document.createElement('div');
            time.className = 'event-time';
            time.textContent = new Date().toLocaleString();

            eventBox.appendChild(title);
            eventBox.appendChild(content);
            eventBox.appendChild(time);

            // Insert at the top
            eventsDiv.insertBefore(eventBox, eventsDiv.firstChild);

            eventCount++;
        }

        // Clear all events
        function clearEvents() {
            const eventsDiv = document.getElementById('events');
            eventsDiv.innerHTML = '<div class="no-events">No events received yet. Waiting for server messages...</div>';
            eventCount = 0;
        }

        // Socket.IO event listeners
        socket.on('connect', () => {
            console.log('Connected to server');
            updateStatus(true);
            displayEvent('connect', 'Successfully connected to server', 'default');
        });

        socket.on('disconnect', () => {
            console.log('Disconnected from server');
            updateStatus(false);
            displayEvent('disconnect', 'Disconnected from server', 'default');
        });

        // Listen for 'message' events
        socket.on('message', (data) => {
            console.log('Message received:', data);
            displayEvent('message', data, 'default');
        });

        // Listen for 'notification' events
        // socket.on('notification', (data) => {
        //     console.log('Notification received:', data);
        //     displayEvent('notification', data, 'notification');
        // });

        // Listen for 'alert' events
        // socket.on('alert', (data) => {
        //     console.log('Alert received:', data);
        //     displayEvent('alert', data, 'alert');
        // });

        // Listen for 'emergency' events
        // socket.on('emergency', (data) => {
        //     console.log('Emergency received:', data);
        //     displayEvent('emergency', data, 'emergency');
        // });

        // Listen for 'custom' events
        socket.on('custom', (data) => {
            console.log('Custom event received:', data);
            displayEvent('custom', data, 'default');
        });

        // Listen for 'update' events
        socket.on('update', (data) => {
            console.log('Update received:', data);
            displayEvent('update', data, 'notification');
        });

        // Catch-all for any other events (optional)
        // Note: This won't work in Socket.IO, you need to register specific events
        // But you can add more listeners above as needed
    </script>
</body>
</html>
